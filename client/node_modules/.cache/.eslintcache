[{"/Users/larsore/Documents/Master/TestPlatform/client/src/index.js":"1","/Users/larsore/Documents/Master/TestPlatform/client/src/reportWebVitals.js":"2","/Users/larsore/Documents/Master/TestPlatform/client/src/App.jsx":"3","/Users/larsore/Documents/Master/TestPlatform/client/src/components/login/index.jsx":"4","/Users/larsore/Documents/Master/TestPlatform/client/src/components/login/login.jsx":"5","/Users/larsore/Documents/Master/TestPlatform/client/src/components/login/register.jsx":"6"},{"size":513,"mtime":1679835298399,"results":"7","hashOfConfig":"8"},{"size":362,"mtime":1679834485959,"results":"9","hashOfConfig":"8"},{"size":1866,"mtime":1679842348514,"results":"10","hashOfConfig":"8"},{"size":96,"mtime":1681904096647,"results":"11","hashOfConfig":"8"},{"size":6410,"mtime":1686898182771,"results":"12","hashOfConfig":"8"},{"size":5990,"mtime":1686899897346,"results":"13","hashOfConfig":"8"},{"filePath":"14","messages":"15","suppressedMessages":"16","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},"s2076a",{"filePath":"17","messages":"18","suppressedMessages":"19","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"20","messages":"21","suppressedMessages":"22","errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"23","messages":"24","suppressedMessages":"25","errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0},{"filePath":"26","messages":"27","suppressedMessages":"28","errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":null},{"filePath":"29","messages":"30","suppressedMessages":"31","errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":0,"source":"32"},"/Users/larsore/Documents/Master/TestPlatform/client/src/index.js",[],[],"/Users/larsore/Documents/Master/TestPlatform/client/src/reportWebVitals.js",[],[],"/Users/larsore/Documents/Master/TestPlatform/client/src/App.jsx",["33","34"],[],"/Users/larsore/Documents/Master/TestPlatform/client/src/components/login/index.jsx",[],[],"/Users/larsore/Documents/Master/TestPlatform/client/src/components/login/login.jsx",["35","36"],[],"/Users/larsore/Documents/Master/TestPlatform/client/src/components/login/register.jsx",["37","38"],[],"import React from 'react';\nimport loginImg from \"../../login.svg\";\nimport { sha256 } from 'js-sha256';\nimport raw from './baseUrl.txt';\n\nexport class Register extends React.Component {\n\n    static username = \"\"\n    static otp = \"\"\n    static RPUrl = \"\";\n    static pollingUrl = \"\";\n    \n    constructor(props) {\n        super(props);\n    }\n\n    static changeLabel(id, text) {\n        document.getElementById(id).innerHTML = text;\n    }\n\n    async handleRegister() {\n        await fetch(raw)\n            .then(r => r.text())\n            .then(text => {\n                Register.RPUrl = text+\":5050\";\n                Register.pollingUrl = text+\":5000\";\n            });\n\n        document.getElementById('RPregResponse').innerHTML = \"\";\n        document.getElementById('authenticatorResponse').innerHTML = \"\";\n        document.getElementById('RPfinalResponse').innerHTML = \"\";\n\n        const username = Register.username;\n        const otp = Register.otp;\n\n        if (username === \"\" || otp === \"\") {\n            Register.changeLabel(\"RPregResponse\", \"Please fill in both a username and an authenticator ID\");\n            return\n        }\n\n        const RPrequestOptions = {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({ \n                \"username\": username,\n                \"otp\": otp\n            })\n        };\n        const RPresponse = await fetch(Register.RPUrl+'/register', RPrequestOptions);\n        const RPdata = await RPresponse.json();\n\n        if (typeof RPdata === 'string') {\n            Register.changeLabel(\"RPregResponse\", RPdata)\n            return\n        }\n        Register.changeLabel(\"RPregResponse\", \"Register information recieved from RP server\")\n        \n        const rp_id = RPdata[\"rp_id\"];\n        const challenge = RPdata[\"challenge\"];\n        const timeout = RPdata[\"timeout\"];\n        \n        var clientData = sha256.create();\n        clientData.update(rp_id);\n        clientData.update(challenge);\n        clientData = clientData.hex()\n\n        const pollingRequestOptions = {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({ \n                \"otp\": otp,\n                \"rp_id\": rp_id,\n                \"client_data\": clientData,\n                \"timeout\": timeout,\n                \"username\": username\n            })\n        };\n        const pollingResponse = await fetch(Register.pollingUrl+'/client/register', pollingRequestOptions);\n        const pollingData = await pollingResponse.json();\n        \n        if (typeof pollingData === 'string') {\n            const registerFailedOptions = {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({ \n                    \"username\": username\n                })\n            };\n            await fetch(Register.RPUrl+'/authenticator/register/failed', registerFailedOptions);\n            \n            Register.changeLabel(\"authenticatorResponse\", pollingData);\n            return\n        }\n        Register.changeLabel(\"authenticatorResponse\", \"Response from authenticator recieved\");\n        \n        const authID = pollingData[\"authenticator_id\"]\n\n        const RPresponseOptions = {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({ \n                \"username\": username,\n                \"credential_id\": pollingData[\"credential_id\"],\n                \"public_key_t\": pollingData[\"public_key_t\"],\n                \"public_key_seed\": pollingData[\"public_key_seed\"],\n                \"client_data\": pollingData[\"client_data\"],\n                \"authenticator_id\": authID\n            })\n        };\n        const RPresponseResponse = await fetch(Register.RPUrl+'/authenticator/register', RPresponseOptions);\n        const RPresponseData = await RPresponseResponse.json();\n        \n        if (typeof RPresponseData !== 'string') {\n            const pollingResultOptions = {\n                method: 'POST',\n                headers: { 'Content-Type': 'application/json' },\n                body: JSON.stringify({ \n                    \"authenticator_id\": authID,\n                    \"username\": username\n                })\n            };\n            await fetch(Register.pollingUrl+'/client/register/failed', pollingResultOptions);\n            \n            Register.changeLabel(\"RPfinalResponse\", RPresponseData[\"reason\"]+\": \"+RPresponseData[\"msg\"]);\n        } else {\n            Register.changeLabel(\"RPfinalResponse\", RPresponseData);\n        } \n    }\n\n    render() {\n        return (\n            <div className=\"base-container\" ref={this.props.containerRef}>\n                <div className='header'>Register</div>\n                <div className='content'>\n                    <div className=\"image\">\n                        <img src={loginImg} />\n                    </div>\n                    <div className=\"form\">\n                        <div className=\"form-group\">\n                            <input type=\"text\" name='username' onChange={(e) => Register.username=e.target.value} placeholder='Username'/>\n                        </div>\n                        <div className=\"form-group\">\n                            <input type=\"text\" name='otp' onChange={(e) => Register.otp=e.target.value} placeholder='One time code'/>\n                        </div>\n                    </div>\n                </div>\n                <div className='informationLabels'>\n                    <label id='RPregResponse'></label>\n                    <label id='authenticatorResponse'></label>\n                    <label id='RPfinalResponse'></label>\n                </div>\n                <div className=\"footer\">\n                    <button type=\"button\" className=\"btn\" onClick={this.handleRegister}>\n                        Register\n                    </button>\n                </div>\n            </div>\n        )\n    }\n}",{"ruleId":"39","severity":1,"message":"40","line":1,"column":16,"nodeType":"41","messageId":"42","endLine":1,"endColumn":24},{"ruleId":"39","severity":1,"message":"43","line":1,"column":26,"nodeType":"41","messageId":"42","endLine":1,"endColumn":35},{"ruleId":"44","severity":1,"message":"45","line":12,"column":5,"nodeType":"46","messageId":"47","endLine":14,"endColumn":6},{"ruleId":"48","severity":1,"message":"49","line":153,"column":25,"nodeType":"50","endLine":153,"endColumn":47},{"ruleId":"44","severity":1,"message":"45","line":13,"column":5,"nodeType":"46","messageId":"47","endLine":15,"endColumn":6},{"ruleId":"48","severity":1,"message":"49","line":136,"column":25,"nodeType":"50","endLine":136,"endColumn":47},"no-unused-vars","'useState' is defined but never used.","Identifier","unusedVar","'useEffect' is defined but never used.","no-useless-constructor","Useless constructor.","MethodDefinition","noUselessConstructor","jsx-a11y/alt-text","img elements must have an alt prop, either with meaningful text, or an empty string for decorative images.","JSXOpeningElement"]