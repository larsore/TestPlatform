<mxfile host="65bd71144e" pages="2">
    <diagram name="Page-1" id="9nSpavD_kLngEqnkLX_T">
        <mxGraphModel dx="6360" dy="1920" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="giV-ENRg7JwK_vnK7Rxu-2" value="Relying Party (verifier)" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="750" y="120" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="rjpO2_44aLAbnIo8vH72-1" value="&lt;font style=&quot;font-size: 36px;&quot;&gt;Registrering&lt;/font&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="1" vertex="1">
                    <mxGeometry x="425" y="40" width="60" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="rjpO2_44aLAbnIo8vH72-2" value="Client" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="395" y="120" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="rjpO2_44aLAbnIo8vH72-3" value="Authenticator (prover)" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="-190" y="120" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="rjpO2_44aLAbnIo8vH72-4" value="" style="endArrow=none;html=1;rounded=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="1" target="rjpO2_44aLAbnIo8vH72-3" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="-130" y="1360" as="sourcePoint"/>
                        <mxPoint x="250" y="250" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="rjpO2_44aLAbnIo8vH72-5" value="" style="endArrow=none;html=1;rounded=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="1" target="rjpO2_44aLAbnIo8vH72-2" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="455" y="1360" as="sourcePoint"/>
                        <mxPoint x="454.58" y="190" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="rjpO2_44aLAbnIo8vH72-6" value="" style="endArrow=none;html=1;rounded=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="1" target="giV-ENRg7JwK_vnK7Rxu-2" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="810" y="1360" as="sourcePoint"/>
                        <mxPoint x="809.58" y="190" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="rjpO2_44aLAbnIo8vH72-7" value="" style="endArrow=classic;html=1;rounded=0;sourcePerimeterSpacing=0;" parent="1" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="460" y="210" as="sourcePoint"/>
                        <mxPoint x="810" y="210" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="rjpO2_44aLAbnIo8vH72-8" value="&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;The client initiates a request to register&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;an authenticator on behalf of the user.&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;Send username + authenticatorID&lt;br&gt;&lt;/font&gt;&lt;/div&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="rjpO2_44aLAbnIo8vH72-7" vertex="1" connectable="0">
                    <mxGeometry x="-0.2" relative="1" as="geometry">
                        <mxPoint x="40" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="rjpO2_44aLAbnIo8vH72-10" value="&lt;div&gt;&lt;u&gt;Credential creation:&lt;/u&gt;&lt;/div&gt;&lt;div&gt;&lt;u&gt;&lt;br&gt;&lt;/u&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;font style=&quot;font-size: 8px;&quot;&gt;- Generate random challenge (string of bytes)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;font style=&quot;font-size: 8px;&quot;&gt;- Add RPid for that specific relying party&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 8px;&quot;&gt;&lt;font style=&quot;font-size: 8px;&quot;&gt;- Randomly generated ID to associate credential to user&lt;/font&gt;&lt;font style=&quot;font-size: 8px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;- Generate publicKeyParams (a set of demands to the public key crypto ac&lt;font style=&quot;font-size: 9px;&quot;&gt;cepted by the relying party (only lattice-crypto for us))&lt;/font&gt;&lt;/font&gt;&lt;/font&gt;&lt;/font&gt;&lt;/font&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;- Authenticator selection: What kind of authenticators are allowed. Either cross-platform or platform authenticator (our app with faceID)&lt;/font&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;- Residential private key: True&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 11px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;- User verification to authenticator: True (ettersom vi beviser vår tilstedeværelse med faceID)&lt;/font&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 11px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;&lt;font style=&quot;font-size: 8px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;- Timeout: Tid på å fullføre registrering (e.g. 30 seconds)&lt;/font&gt;&lt;/font&gt;&lt;/font&gt;&lt;/font&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font style=&quot;font-size: 11px;&quot;&gt;&lt;font style=&quot;font-size: 10px;&quot;&gt;&lt;font style=&quot;font-size: 9px;&quot;&gt;- Attestation: Verifisere at authenticatoren er legitim (dette legger vi til evt. etter hvert)&lt;/font&gt;&lt;/font&gt;&lt;/font&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="840" y="300" width="380" height="190" as="geometry"/>
                </mxCell>
                <mxCell id="rjpO2_44aLAbnIo8vH72-11" value="" style="endArrow=none;html=1;rounded=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;startArrow=classic;startFill=1;" parent="1" source="rjpO2_44aLAbnIo8vH72-10" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="890" y="280" as="sourcePoint"/>
                        <mxPoint x="810" y="240" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="1030" y="240"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="rjpO2_44aLAbnIo8vH72-12" value="" style="endArrow=classic;html=1;rounded=0;" parent="1" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="810" y="520" as="sourcePoint"/>
                        <mxPoint x="460" y="520" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="rjpO2_44aLAbnIo8vH72-14" value="&lt;pre style=&quot;font-size: 6px;&quot;&gt;{&lt;br&gt;  &quot;publicKey&quot;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;br&gt;    &lt;span class=&quot;s2&quot;&gt;&quot;attestation&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;none&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;br&gt;    &lt;span class=&quot;s2&quot;&gt;&quot;authenticatorSelection&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;br&gt;      &lt;span class=&quot;s2&quot;&gt;&quot;authenticatorAttachment&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;platform&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;br&gt;      &lt;span class=&quot;s2&quot;&gt;&quot;requireResidentKey&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; true&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;br&gt;      &lt;span class=&quot;s2&quot;&gt;&quot;userVerification&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;required&quot;&lt;/span&gt;&lt;br&gt;    &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;br&gt;    &lt;span class=&quot;s2&quot;&gt;&quot;challenge&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &quot;random bytes&quot;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;br&gt;    &lt;span class=&quot;s2&quot;&gt;&quot;excludeCredentials&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[],&lt;/span&gt;&lt;br&gt;    &lt;span class=&quot;s2&quot;&gt;&quot;pubKeyCredParams&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;[&lt;/span&gt;&lt;br&gt;      &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;br&gt;        &lt;span class=&quot;s2&quot;&gt;&quot;alg&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &quot;BabyDilithium&quot;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;br&gt;        &lt;span class=&quot;s2&quot;&gt;&quot;type&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;public-key&quot;&lt;/span&gt;&lt;br&gt;      &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;br&gt;    &lt;span class=&quot;p&quot;&gt;],&lt;/span&gt;&lt;br&gt;    &lt;span class=&quot;s2&quot;&gt;&quot;rp&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;br&gt;      &lt;span class=&quot;s2&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;OurUrl&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;br&gt;      &lt;span class=&quot;s2&quot;&gt;&quot;name&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Master&quot;&lt;/span&gt;&lt;br&gt;    &lt;span class=&quot;p&quot;&gt;},&lt;/span&gt;&lt;br&gt;    &lt;span class=&quot;s2&quot;&gt;&quot;timeout&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;mi&quot;&gt;30000&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;br&gt;    &lt;span class=&quot;s2&quot;&gt;&quot;user&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;p&quot;&gt;{&lt;/span&gt;&lt;br&gt;      &lt;span class=&quot;s2&quot;&gt;&quot;displayName&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;Lars&quot;&lt;/span&gt;&lt;span class=&quot;p&quot;&gt;,&lt;/span&gt;&lt;br&gt;      &lt;span class=&quot;s2&quot;&gt;&quot;id&quot;&lt;/span&gt;&lt;span class=&quot;o&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;s2&quot;&gt;&quot;random unique ID&quot;&lt;/span&gt;&lt;br&gt;    &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;br&gt;  &lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;br&gt;&lt;span class=&quot;p&quot;&gt;}&lt;/span&gt;&lt;/pre&gt;" style="edgeLabel;html=1;align=left;verticalAlign=middle;resizable=0;points=[];labelBackgroundColor=default;labelBorderColor=default;" parent="rjpO2_44aLAbnIo8vH72-12" vertex="1" connectable="0">
                    <mxGeometry x="0.5196" relative="1" as="geometry">
                        <mxPoint x="6" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="rjpO2_44aLAbnIo8vH72-15" value="" style="endArrow=classic;html=1;rounded=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="rjpO2_44aLAbnIo8vH72-10" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="710" y="540" as="sourcePoint"/>
                        <mxPoint x="810" y="520" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="1030" y="520"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="rjpO2_44aLAbnIo8vH72-16" value="" style="endArrow=none;html=1;rounded=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;endFill=0;startArrow=classic;startFill=1;" parent="1" source="rjpO2_44aLAbnIo8vH72-17" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="320" y="600" as="sourcePoint"/>
                        <mxPoint x="450" y="520" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="380" y="520"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="rjpO2_44aLAbnIo8vH72-17" value="&lt;div&gt;Check that rp[id] == HTTPOrigin header&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;clientData = Hash(rp[id] + challenge)&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=6;" parent="1" vertex="1">
                    <mxGeometry x="320" y="550" width="120" height="70" as="geometry"/>
                </mxCell>
                <mxCell id="rjpO2_44aLAbnIo8vH72-19" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="rjpO2_44aLAbnIo8vH72-17" target="rjpO2_44aLAbnIo8vH72-20" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="500" y="680" as="sourcePoint"/>
                        <mxPoint x="380" y="640" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="rjpO2_44aLAbnIo8vH72-20" value="" style="rhombus;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="365" y="650" width="30" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="rjpO2_44aLAbnIo8vH72-21" value="" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="rjpO2_44aLAbnIo8vH72-20" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="500" y="680" as="sourcePoint"/>
                        <mxPoint x="810" y="665" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="rjpO2_44aLAbnIo8vH72-22" value="if not match: Reject" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="rjpO2_44aLAbnIo8vH72-21" vertex="1" connectable="0">
                    <mxGeometry x="-0.094" y="1" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="rjpO2_44aLAbnIo8vH72-23" value="" style="endArrow=classic;html=1;rounded=0;exitX=0;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="rjpO2_44aLAbnIo8vH72-20" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="400" y="690" as="sourcePoint"/>
                        <mxPoint x="130" y="665" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="rjpO2_44aLAbnIo8vH72-25" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;if match: Forward credential + clientData&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=8;labelBackgroundColor=default;labelBorderColor=default;" parent="rjpO2_44aLAbnIo8vH72-23" vertex="1" connectable="0">
                    <mxGeometry x="-0.1446" y="1" relative="1" as="geometry">
                        <mxPoint y="-1" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="rjpO2_44aLAbnIo8vH72-27" value="&lt;div&gt;Åpne app og verify user presence:&lt;/div&gt;&lt;ul&gt;&lt;li&gt;Generate asymmetric key pair&lt;br&gt;&lt;/li&gt;&lt;li&gt;Create random credential ID&lt;/li&gt;&lt;li&gt;Store (private key, rp[id] and credential ID)&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=8;align=left;" parent="1" vertex="1">
                    <mxGeometry x="-360" y="950" width="200" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="rjpO2_44aLAbnIo8vH72-31" value="&lt;div align=&quot;left&quot;&gt;&lt;ul&gt;&lt;li&gt;Verify HTTP Origin header&lt;/li&gt;&lt;li&gt;Verify clientData == Hash(rp[id] + challenge)&lt;/li&gt;&lt;li&gt;If the above is true&lt;br&gt;&lt;/li&gt;&lt;ul&gt;&lt;li&gt;Store (user ID, credential ID, public key)&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/ul&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="835" y="1160" width="310" height="90" as="geometry"/>
                </mxCell>
                <mxCell id="rjpO2_44aLAbnIo8vH72-34" value="" style="endArrow=classic;html=1;rounded=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" target="rjpO2_44aLAbnIo8vH72-31" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="810" y="1130" as="sourcePoint"/>
                        <mxPoint x="885" y="1140" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="990" y="1130"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="rjpO2_44aLAbnIo8vH72-35" value="" style="endArrow=classic;html=1;rounded=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="rjpO2_44aLAbnIo8vH72-31" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="835" y="1280" as="sourcePoint"/>
                        <mxPoint x="455" y="1290" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="990" y="1290"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="rjpO2_44aLAbnIo8vH72-36" value="Result" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="rjpO2_44aLAbnIo8vH72-35" vertex="1" connectable="0">
                    <mxGeometry x="0.2681" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="VyJtqUMelZ7oASCZ94De-1" value="Polling Server" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="70" y="540" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="VyJtqUMelZ7oASCZ94De-2" value="" style="endArrow=none;html=1;rounded=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="1" target="VyJtqUMelZ7oASCZ94De-1" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="130" y="1360" as="sourcePoint"/>
                        <mxPoint x="140" y="280" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="VyJtqUMelZ7oASCZ94De-6" value="" style="endArrow=classic;html=1;rounded=0;" parent="1" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="-130" y="760" as="sourcePoint"/>
                        <mxPoint x="130" y="760" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="VyJtqUMelZ7oASCZ94De-7" value="Poll server. &lt;br&gt;Check if data for my authID exists" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="VyJtqUMelZ7oASCZ94De-6" vertex="1" connectable="0">
                    <mxGeometry x="-0.2029" relative="1" as="geometry">
                        <mxPoint x="28" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="VyJtqUMelZ7oASCZ94De-9" value="" style="endArrow=classic;html=1;rounded=0;exitX=0;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="VyJtqUMelZ7oASCZ94De-11" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="-30" y="790" as="sourcePoint"/>
                        <mxPoint x="-130" y="825" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="VyJtqUMelZ7oASCZ94De-10" value="If no: return FALSE" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="VyJtqUMelZ7oASCZ94De-9" vertex="1" connectable="0">
                    <mxGeometry x="0.0192" y="1" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="VyJtqUMelZ7oASCZ94De-11" value="" style="rhombus;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="60" y="810" width="30" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="VyJtqUMelZ7oASCZ94De-12" value="" style="endArrow=none;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="VyJtqUMelZ7oASCZ94De-11" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="60" y="900" as="sourcePoint"/>
                        <mxPoint x="130" y="825" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="VyJtqUMelZ7oASCZ94De-13" value="" style="endArrow=classic;html=1;rounded=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="VyJtqUMelZ7oASCZ94De-11" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="60" y="970" as="sourcePoint"/>
                        <mxPoint x="-130" y="880" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="75" y="880"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="VyJtqUMelZ7oASCZ94De-14" value="If match: return &lt;br&gt;credential + clientData" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="VyJtqUMelZ7oASCZ94De-13" vertex="1" connectable="0">
                    <mxGeometry x="0.1973" y="-2" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="VyJtqUMelZ7oASCZ94De-15" value="" style="endArrow=none;html=1;rounded=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;" parent="1" source="rjpO2_44aLAbnIo8vH72-27" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="-250" y="910" as="sourcePoint"/>
                        <mxPoint x="-130" y="920" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="-260" y="920"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="VyJtqUMelZ7oASCZ94De-16" value="" style="endArrow=classic;html=1;rounded=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="-260" y="1030" as="sourcePoint"/>
                        <mxPoint x="455" y="1080" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="-260" y="1080"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="VyJtqUMelZ7oASCZ94De-4" value="&lt;div style=&quot;border-color: var(--border-color); font-size: 8px; text-align: left; background-color: rgb(255, 255, 255);&quot;&gt;{&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); font-size: 8px; text-align: left; background-color: rgb(255, 255, 255);&quot;&gt;public key,&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); font-size: 8px; text-align: left; background-color: rgb(255, 255, 255);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&lt;/span&gt;credential ID,&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); font-size: 8px; text-align: left; background-color: rgb(255, 255, 255);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&lt;/span&gt;clientData (attestation)&lt;br style=&quot;border-color: var(--border-color);&quot;&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); font-size: 8px; text-align: left; background-color: rgb(255, 255, 255);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&lt;/span&gt;signature (attestation)&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); font-size: 8px; text-align: left; background-color: rgb(255, 255, 255);&quot;&gt;}&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="230" y="1050" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="VyJtqUMelZ7oASCZ94De-17" value="" style="endArrow=classic;html=1;rounded=0;" parent="1" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="460" y="1100" as="sourcePoint"/>
                        <mxPoint x="810" y="1100" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="sGyqYSbfdkbCB0a28GjR-7" value="&lt;div style=&quot;border-color: var(--border-color); font-size: 8px; text-align: left; background-color: rgb(255, 255, 255);&quot;&gt;{&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); font-size: 8px; text-align: left; background-color: rgb(255, 255, 255);&quot;&gt;public key,&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); font-size: 8px; text-align: left; background-color: rgb(255, 255, 255);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&lt;/span&gt;credential ID,&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); font-size: 8px; text-align: left; background-color: rgb(255, 255, 255);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&lt;/span&gt;clientData (attestation)&lt;br style=&quot;border-color: var(--border-color);&quot;&gt;&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); font-size: 8px; text-align: left; background-color: rgb(255, 255, 255);&quot;&gt;&lt;span style=&quot;border-color: var(--border-color);&quot;&gt;&lt;/span&gt;signature (attestation)&lt;/div&gt;&lt;div style=&quot;border-color: var(--border-color); font-size: 8px; text-align: left; background-color: rgb(255, 255, 255);&quot;&gt;}&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="570" y="1070" width="120" height="60" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
    <diagram id="IM2ip-CZQZaXiK0-1fHI" name="Page-2">
        <mxGraphModel dx="1871" dy="419" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
            <root>
                <mxCell id="0"/>
                <mxCell id="1" parent="0"/>
                <mxCell id="QToWJEquE7XdQLOFN0ek-1" value="Relying Party (verifier)" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="750" y="120" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="QToWJEquE7XdQLOFN0ek-2" value="Autentisering" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=38;" parent="1" vertex="1">
                    <mxGeometry x="425" y="40" width="60" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="QToWJEquE7XdQLOFN0ek-3" value="Client" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="395" y="120" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="QToWJEquE7XdQLOFN0ek-4" value="Authenticator (prover)" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="-190" y="120" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="QToWJEquE7XdQLOFN0ek-5" value="" style="endArrow=none;html=1;rounded=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="1" target="QToWJEquE7XdQLOFN0ek-4" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="-130" y="1100" as="sourcePoint"/>
                        <mxPoint x="250" y="250" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="-130" y="590"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="QToWJEquE7XdQLOFN0ek-6" value="" style="endArrow=none;html=1;rounded=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="1" target="QToWJEquE7XdQLOFN0ek-3" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="455" y="1100" as="sourcePoint"/>
                        <mxPoint x="454.58" y="190" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="QToWJEquE7XdQLOFN0ek-7" value="" style="endArrow=none;html=1;rounded=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="1" target="QToWJEquE7XdQLOFN0ek-1" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="810" y="1100" as="sourcePoint"/>
                        <mxPoint x="809.58" y="190" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="QToWJEquE7XdQLOFN0ek-8" value="" style="endArrow=classic;html=1;rounded=0;sourcePerimeterSpacing=0;" parent="1" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="455" y="210" as="sourcePoint"/>
                        <mxPoint x="810" y="210" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="QToWJEquE7XdQLOFN0ek-9" value="&lt;div style=&quot;font-size: 8px;&quot;&gt;The client initiates a request to&lt;/div&gt;&lt;div style=&quot;font-size: 8px;&quot;&gt;authenticate on behalf of the user&lt;/div&gt;&lt;div style=&quot;font-size: 8px;&quot;&gt;Send kun brukernavn&lt;br style=&quot;font-size: 8px;&quot;&gt;&lt;/div&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=8;" parent="QToWJEquE7XdQLOFN0ek-8" vertex="1" connectable="0">
                    <mxGeometry x="-0.2" relative="1" as="geometry">
                        <mxPoint x="30" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="QToWJEquE7XdQLOFN0ek-12" value="" style="endArrow=classic;html=1;rounded=0;" parent="1" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="810" y="280" as="sourcePoint"/>
                        <mxPoint x="455" y="280" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="QToWJEquE7XdQLOFN0ek-32" value="&lt;div style=&quot;font-size: 7px;&quot; align=&quot;left&quot;&gt;{&lt;/div&gt;&lt;div style=&quot;font-size: 7px;&quot; align=&quot;left&quot;&gt;&lt;span style=&quot;white-space: pre; font-size: 7px;&quot;&gt;&#9;&lt;/span&gt;rp id,&lt;/div&gt;&lt;div style=&quot;font-size: 7px;&quot; align=&quot;left&quot;&gt;&lt;span style=&quot;white-space: pre; font-size: 7px;&quot;&gt;&#9;&lt;/span&gt;credential id,&lt;/div&gt;&lt;div style=&quot;font-size: 7px;&quot; align=&quot;left&quot;&gt;&lt;span style=&quot;white-space: pre; font-size: 7px;&quot;&gt;&#9;&lt;/span&gt;challenge&lt;br style=&quot;font-size: 7px;&quot;&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 7px;&quot; align=&quot;left&quot;&gt;}&lt;/div&gt;&lt;div style=&quot;font-size: 7px;&quot; align=&quot;left&quot;&gt;&lt;br style=&quot;font-size: 7px;&quot;&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 7px;&quot; align=&quot;left&quot;&gt;Credential ID hentes ut i database&lt;/div&gt;&lt;div style=&quot;font-size: 7px;&quot; align=&quot;left&quot;&gt;matchet med unikt brukernavn.&lt;/div&gt;&lt;div style=&quot;font-size: 7px;&quot; align=&quot;left&quot;&gt;&lt;br style=&quot;font-size: 7px;&quot;&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 7px;&quot; align=&quot;left&quot;&gt;Challenge er en random streng med bytes&lt;br style=&quot;font-size: 7px;&quot;&gt;&lt;/div&gt;" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];fontSize=7;" parent="QToWJEquE7XdQLOFN0ek-12" vertex="1" connectable="0">
                    <mxGeometry x="0.031" y="-1" relative="1" as="geometry">
                        <mxPoint y="11" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="QToWJEquE7XdQLOFN0ek-15" value="" style="endArrow=none;html=1;rounded=1;exitX=0.5;exitY=0;exitDx=0;exitDy=0;endFill=0;startArrow=classic;startFill=1;" parent="1" source="QToWJEquE7XdQLOFN0ek-16" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="320" y="360" as="sourcePoint"/>
                        <mxPoint x="455" y="280" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="380" y="280"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="QToWJEquE7XdQLOFN0ek-16" value="&lt;div&gt;Check that rp[id] == HTTPOrigin header&lt;/div&gt;&lt;div&gt;clientData = Hash(rp[id] + challenge)&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=6;" parent="1" vertex="1">
                    <mxGeometry x="325" y="310" width="110" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="QToWJEquE7XdQLOFN0ek-17" value="" style="endArrow=classic;html=1;rounded=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="QToWJEquE7XdQLOFN0ek-16" target="QToWJEquE7XdQLOFN0ek-18" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="500" y="440" as="sourcePoint"/>
                        <mxPoint x="380" y="400" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="QToWJEquE7XdQLOFN0ek-18" value="" style="rhombus;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="365" y="370" width="30" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="QToWJEquE7XdQLOFN0ek-19" value="" style="endArrow=classic;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="QToWJEquE7XdQLOFN0ek-18" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="500" y="440" as="sourcePoint"/>
                        <mxPoint x="810" y="385" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="QToWJEquE7XdQLOFN0ek-20" value="if not match: Reject" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="QToWJEquE7XdQLOFN0ek-19" vertex="1" connectable="0">
                    <mxGeometry x="-0.094" y="1" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="QToWJEquE7XdQLOFN0ek-21" value="" style="endArrow=classic;html=1;rounded=0;exitX=0;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="QToWJEquE7XdQLOFN0ek-18" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="400" y="450" as="sourcePoint"/>
                        <mxPoint x="130" y="385" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="QToWJEquE7XdQLOFN0ek-22" value="&lt;div style=&quot;font-size: 8px;&quot; align=&quot;left&quot;&gt;if match: Forward&lt;/div&gt;&lt;div style=&quot;font-size: 8px;&quot; align=&quot;left&quot;&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 8px;&quot; align=&quot;left&quot;&gt;{&lt;/div&gt;&lt;div style=&quot;font-size: 8px;&quot; align=&quot;left&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#9;&lt;/span&gt;credential ID,&lt;/div&gt;&lt;div style=&quot;font-size: 8px;&quot; align=&quot;left&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#9;&lt;/span&gt;clientData,&lt;/div&gt;&lt;div style=&quot;font-size: 8px;&quot; align=&quot;left&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#9;&lt;/span&gt;rp ID&lt;/div&gt;&lt;div style=&quot;font-size: 8px;&quot; align=&quot;left&quot;&gt;}&lt;br&gt;&lt;/div&gt;&lt;div align=&quot;left&quot;&gt;&lt;br&gt;&lt;/div&gt;" style="edgeLabel;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=8;labelBackgroundColor=default;labelBorderColor=default;" parent="QToWJEquE7XdQLOFN0ek-21" vertex="1" connectable="0">
                    <mxGeometry x="-0.1446" y="1" relative="1" as="geometry">
                        <mxPoint x="-31" y="-1" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="QToWJEquE7XdQLOFN0ek-23" value="" style="endArrow=classic;html=1;rounded=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" target="QToWJEquE7XdQLOFN0ek-24" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="-130" y="580" as="sourcePoint"/>
                        <mxPoint x="-230" y="570" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="-240" y="580"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="QToWJEquE7XdQLOFN0ek-24" value="&lt;div&gt;Åpne push-varsel og verify user presence med faceID:&lt;/div&gt;&lt;ul&gt;&lt;li&gt;Get correct private key associated with credential ID&lt;/li&gt;&lt;li&gt;Verify that stored rp ID == received rp ID&lt;/li&gt;&lt;li&gt;Sign clientData with private key&lt;/li&gt;&lt;li&gt;Authenticator data = Hash(stored rp ID)&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;" style="rounded=1;whiteSpace=wrap;html=1;fontSize=8;align=left;" parent="1" vertex="1">
                    <mxGeometry x="-340" y="620" width="200" height="80" as="geometry"/>
                </mxCell>
                <mxCell id="cYzWqYtb603Sg9v7bhxR-1" value="" style="endArrow=classic;html=1;rounded=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="QToWJEquE7XdQLOFN0ek-24" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="120" y="550" as="sourcePoint"/>
                        <mxPoint x="455" y="720" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="-240" y="720"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="cYzWqYtb603Sg9v7bhxR-2" value="&lt;div style=&quot;font-size: 10px;&quot;&gt;{&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;span style=&quot;white-space: pre; font-size: 10px;&quot;&gt;&#9;&lt;/span&gt;signature,&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;span style=&quot;white-space: pre; font-size: 10px;&quot;&gt;&#9;&lt;/span&gt;Authenticator data&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;}&lt;/div&gt;" style="edgeLabel;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=10;labelBorderColor=default;" parent="cYzWqYtb603Sg9v7bhxR-1" vertex="1" connectable="0">
                    <mxGeometry x="0.2516" y="2" relative="1" as="geometry">
                        <mxPoint x="39" y="2" as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="cYzWqYtb603Sg9v7bhxR-4" value="" style="endArrow=classic;html=1;rounded=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" target="cYzWqYtb603Sg9v7bhxR-5" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="810" y="800" as="sourcePoint"/>
                        <mxPoint x="950" y="940" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="1040" y="800"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="cYzWqYtb603Sg9v7bhxR-5" value="&lt;div&gt;Check if:&lt;/div&gt;&lt;div&gt;&lt;ul&gt;&lt;li&gt;Hash(clientDataJSON) == Hash(rp ID + chellenge)&lt;/li&gt;&lt;li&gt;autheticator Data == Hash(rp ID)&lt;/li&gt;&lt;li&gt;Verify signature with stored public key&lt;br&gt;&lt;/li&gt;&lt;/ul&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=left;" parent="1" vertex="1">
                    <mxGeometry x="870" y="840" width="340" height="140" as="geometry"/>
                </mxCell>
                <mxCell id="cYzWqYtb603Sg9v7bhxR-6" value="" style="endArrow=classic;html=1;rounded=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="cYzWqYtb603Sg9v7bhxR-5" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="800" y="790" as="sourcePoint"/>
                        <mxPoint x="455" y="1040" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="1040" y="1040"/>
                            <mxPoint x="680" y="1040"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="cYzWqYtb603Sg9v7bhxR-7" value="Result" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="cYzWqYtb603Sg9v7bhxR-6" vertex="1" connectable="0">
                    <mxGeometry x="0.3246" y="-2" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="34IDZtclGxJptvFGO13U-1" value="Polling Server" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="70" y="120" width="120" height="60" as="geometry"/>
                </mxCell>
                <mxCell id="34IDZtclGxJptvFGO13U-2" value="" style="endArrow=none;html=1;rounded=0;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="1" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="130" y="1100" as="sourcePoint"/>
                        <mxPoint x="129.66" y="180" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="129.66" y="590"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="34IDZtclGxJptvFGO13U-4" value="" style="endArrow=classic;html=1;rounded=0;" parent="1" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="-130" y="440" as="sourcePoint"/>
                        <mxPoint x="130" y="440" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="34IDZtclGxJptvFGO13U-5" value="Poll" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="34IDZtclGxJptvFGO13U-4" vertex="1" connectable="0">
                    <mxGeometry x="-0.0813" y="1" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="Z9CXAvIN54B3BoTS-VPd-7" value="" style="endArrow=classic;html=1;rounded=0;exitX=0;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="Z9CXAvIN54B3BoTS-VPd-9" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="-30" y="440" as="sourcePoint"/>
                        <mxPoint x="-130" y="475" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="Z9CXAvIN54B3BoTS-VPd-8" value="If no: return FALSE" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="Z9CXAvIN54B3BoTS-VPd-7" vertex="1" connectable="0">
                    <mxGeometry x="0.0192" y="1" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="Z9CXAvIN54B3BoTS-VPd-9" value="" style="rhombus;whiteSpace=wrap;html=1;" parent="1" vertex="1">
                    <mxGeometry x="60" y="460" width="30" height="30" as="geometry"/>
                </mxCell>
                <mxCell id="Z9CXAvIN54B3BoTS-VPd-10" value="" style="endArrow=none;html=1;rounded=0;exitX=1;exitY=0.5;exitDx=0;exitDy=0;" parent="1" source="Z9CXAvIN54B3BoTS-VPd-9" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="60" y="550" as="sourcePoint"/>
                        <mxPoint x="130" y="475" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="Z9CXAvIN54B3BoTS-VPd-11" value="" style="endArrow=classic;html=1;rounded=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="Z9CXAvIN54B3BoTS-VPd-9" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="60" y="620" as="sourcePoint"/>
                        <mxPoint x="-130" y="530" as="targetPoint"/>
                        <Array as="points">
                            <mxPoint x="75" y="530"/>
                        </Array>
                    </mxGeometry>
                </mxCell>
                <mxCell id="Z9CXAvIN54B3BoTS-VPd-12" value="If match: return &lt;br&gt;credentialID, clientData, rpID" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="Z9CXAvIN54B3BoTS-VPd-11" vertex="1" connectable="0">
                    <mxGeometry x="0.1973" y="-2" relative="1" as="geometry">
                        <mxPoint as="offset"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="19OfvTUxoqTfh5sdy2IY-2" value="" style="endArrow=classic;html=1;rounded=0;" parent="1" edge="1">
                    <mxGeometry width="50" height="50" relative="1" as="geometry">
                        <mxPoint x="455" y="760" as="sourcePoint"/>
                        <mxPoint x="810" y="760" as="targetPoint"/>
                    </mxGeometry>
                </mxCell>
                <mxCell id="cYzWqYtb603Sg9v7bhxR-3" value="&lt;div style=&quot;font-size: 10px;&quot;&gt;{&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;span style=&quot;white-space: pre; font-size: 10px;&quot;&gt;&#9;&lt;/span&gt;signature,&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;span style=&quot;white-space: pre; font-size: 10px;&quot;&gt;&#9;&lt;/span&gt;clientDataJSON = rp[id] + challenge,&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#9;&lt;/span&gt;authenticator data&lt;br style=&quot;font-size: 10px;&quot;&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 10px;&quot;&gt;}&lt;/div&gt;" style="edgeLabel;html=1;align=left;verticalAlign=middle;resizable=0;points=[];fontSize=10;labelBorderColor=default;" parent="1" vertex="1" connectable="0">
                    <mxGeometry x="539.9981818181818" y="759.9999999999999" as="geometry"/>
                </mxCell>
            </root>
        </mxGraphModel>
    </diagram>
</mxfile>